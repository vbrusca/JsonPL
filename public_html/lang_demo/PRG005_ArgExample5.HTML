<html>
    <head>
    <link rel="stylesheet" href="style.css">         
    <title>JsonPL Program: PRG005_ArgExample5.HTML</title>
    <script type="text/javascript" src="../EXEC4.JS"></script>
    <script type="text/javascript">
        try {
            var code = {"sys":"class", "name":"ArgExample4",
                "ret":{"sys":"val", "type":"int", "v":"0"},
                "call":{"sys":"call", "name":"main", "args":[
                        {"sys":"ref", "val":{"sys":"val", "type":"int[]", "strict":"true", "len":"2", "v":"#.vars.ar1"}}
                    ]
                },
                "classes":[],
                "vars":[
                    {"sys":"var", "name":"ar1", "val":{"sys":"val", "type":"int[]", "strict":"true", "len":"2", "v":[
                                {"sys":"var", "name":"itm0", "val":{"sys":"val", "type":"int", "v":"100"}},
                                {"sys":"var", "name":"itm1", "val":{"sys":"val", "type":"int", "v":"200"}}                                    
                            ]
                        }
                    } 
                ],
                "funcs":[
                    {"sys":"func", "name":"main",
                        "ret":{"sys":"val", "type":"int", "v":"0"},
                        "vars":[
                            {"sys":"var", "name":"ar2", "val":{"sys":"val", "type":"int[]", "strict":"true", "len":"2", "v":[
                                        {"sys":"var", "name":"itm0", "val":{"sys":"val", "type":"int", "v":"0"}},
                                        {"sys":"var", "name":"itm1", "val":{"sys":"val", "type":"int", "v":"1"}}                                    
                                    ]
                                }
                            }
                        ],
                        "args":[
                            {"sys":"arg", "name":"ar3", "val":{"sys":"val", "type":"int[]", "strict":"true", "len":"2", "v":[
                                        {"sys":"arg", "name":"itm0", "val":{"sys":"val", "type":"int", "v":"0"}},
                                        {"sys":"arg", "name":"itm1", "val":{"sys":"val", "type":"int", "v":"1"}}                                    
                                    ]
                                }
                            }
                        ],
                        "lines":[
                            {"sys":"asgn", "left":{"sys":"ref", "val":{"sys":"val", "type":"int", "v":"#.vars.ar1"}},
                                "op":{"sys":"op", "type":"asgn", "v":"="},
                                "right":{"sys":"ref", "val":{"sys":"val", "type":"int", "v":"$.args.ar3"}}
                            },
                            {"sys":"asgn", "left":{"sys":"ref", "val":{"sys":"val", "type":"int", "v":"$.vars.ar2"}},
                                "op":{"sys":"op", "type":"asgn", "v":"="},
                                "right":{"sys":"ref", "val":{"sys":"val", "type":"int", "v":"$.args.ar3"}}
                            },
                            {"sys":"call", "name":"SYS::wr", "args":[
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":"Found class array variable, ar1, by index"}},
                                    
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":", "}},
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":"#.vars.ar1.0 = "}},
                                    {"sys":"ref", "val":{"sys":"val", "type":"int", "v":"#.vars.ar1.0"}},
                                    
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":", "}},
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":"#.vars.ar1.1 = "}},
                                    {"sys":"ref", "val":{"sys":"val", "type":"int", "v":"#.vars.ar1.1"}},
                                ]
                            },
                            {"sys":"call", "name":"SYS::wr", "args":[
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":"Found class array variable, ar1, by name"}},
                                    
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":", "}},
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":"#.vars.ar1.itm0 = "}},
                                    {"sys":"ref", "val":{"sys":"val", "type":"int", "v":"#.vars.ar1.itm0"}},
                                    
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":", "}},
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":"#.vars.ar1.itm1 = "}},
                                    {"sys":"ref", "val":{"sys":"val", "type":"int", "v":"#.vars.ar1.itm1"}},
                                ]
                            },                            
                            {"sys":"call", "name":"SYS::wr", "args":[
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":"Found func array variable, ar2, by index"}},
                                                                        
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":", "}},
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":"$.vars.ar2.0 = "}},
                                    {"sys":"ref", "val":{"sys":"val", "type":"int", "v":"$.vars.ar2.0"}},

                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":", "}},
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":"$.vars.ar2.1 = "}},
                                    {"sys":"ref", "val":{"sys":"val", "type":"int", "v":"$.vars.ar2.1"}}                                    
                                ]
                            },
                            {"sys":"call", "name":"SYS::wr", "args":[
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":"Found func array variable, ar2, by name"}},
                                                                        
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":", "}},
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":"$.vars.ar2.itm0 = "}},
                                    {"sys":"ref", "val":{"sys":"val", "type":"int", "v":"$.vars.ar2.itm0"}},

                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":", "}},
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":"$.vars.ar2.itm1 = "}},
                                    {"sys":"ref", "val":{"sys":"val", "type":"int", "v":"$.vars.ar2.itm1"}}                                    
                                ]
                            },                            
                            {"sys":"call", "name":"SYS::wr", "args":[
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":"Found func array argument, ar3, by index"}},
                                                                        
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":", "}},
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":"$.args.ar3.0 = "}},
                                    {"sys":"ref", "val":{"sys":"val", "type":"int", "v":"$.args.ar3.0"}},

                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":", "}},
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":"$.args.ar3.1 = "}},
                                    {"sys":"ref", "val":{"sys":"val", "type":"int", "v":"$.args.ar3.1"}}                                    
                                ]
                            },
                            {"sys":"call", "name":"SYS::wr", "args":[
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":"Found func array argument, ar3, by name"}},
                                                                        
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":", "}},
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":"$.args.ar3.itm0 = "}},
                                    {"sys":"ref", "val":{"sys":"val", "type":"int", "v":"$.args.ar3.itm0"}},

                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":", "}},
                                    {"sys":"const", "val":{"sys":"val", "type":"string", "v":"$.args.ar3.itm1 = "}},
                                    {"sys":"ref", "val":{"sys":"val", "type":"int", "v":"$.args.ar3.itm1"}}
                                ]
                            },
                            {"sys":"return", "val":{"sys":"const", "val":{"sys":"val", "type":"int", "v":"1"}}}
                        ]
                    }
                ]
            };
         
            /**
             * Name: init
             * Desc: A function to init the test page.
             */
            function init() {
                var txtAreaMsg = document.getElementById("message");
                var txtAreaSrc = document.getElementById("source");
                var nl = "\r\n";         

                jsonPlState.prototype.wr = function(s) {
                    if (this.LOGGING === true) {
                        console.log(this.WR_PREFIX + s);
                        txtAreaMsg.value += (this.WR_PREFIX + s + nl);
                    }
                };
            
                jsonPlState.prototype.wrObj = function(s) {
                    if (this.LOGGING === true) {
                        console.log(this.WR_PREFIX + JSON.stringify(s, null, 2));
                        txtAreaMsg.value += (this.WR_PREFIX + JSON.stringify(s, null, 2) + nl);
                    }
                };

                jsonPlState.prototype.wrVal = function(v) {
                    if (this.LOGGING === true) {
                        if(this.isSysObjValArray(v)) {
                            console.log(this.WR_PREFIX + "Val Obj: Type: " + v.type + " len: " + v.len);
                            txtAreaMsg.value += (this.WR_PREFIX + "Val Obj: Type: " + v.type + " len: " + v.len + nl);
                        } else {
                            console.log(this.WR_PREFIX + "Val Obj: Type: " + v.type + " v: " + v.v);
                            txtAreaMsg.value += (this.WR_PREFIX + "Val Obj: Type: " + v.type + " v: " + v.v + nl);
                        }
                    }
                };
         
                /////////////////////////PROGRAM SECTION
                var jpl = new jsonPlState();
                var codeStr = JSON.stringify(code, null, 2);
                txtAreaSrc.value += codeStr;
                jpl.program = JSON.parse(codeStr);
            
                if(!jpl.validateSysObjClass(jpl.program)) {
                    jpl.wr("runProgram: Error: could not validate the class object.");
                    return;
                }

                jpl.wr("====================== Program Results ======================");
                jpl.runProgram();             
            }
        } catch(e) {
            txtAreaSrc.value = "Error:";
            txtAreaSrc.value += "Message:" + e;
        }
        </script>
    </head>
    <body style="padding: 6px;" onload="init()">
        <span style="font-size:18px; font-weight:bold;">Output:</span>
        <br/>
<textarea cols="90" rows="15" id="message" style="font-size:16px;">
</textarea>    
        <br/><br/>

        <span style="font-size:18px; font-weight:bold;">Source:</span>
        <br/>
<textarea cols="90" rows="5" id="source" style="font-size:16px;">
</textarea>
        <br/><br/>

        <div style="float:left; clear:both;">
            <span style="font-size:18px; font-weight:bold;">Title:</span>
            <span style="font-size:18px; font-weight:normal;">JsonPL Program: PRG005 - ArgExample5</span>
        </div>
        <div style="float:left; clear:both;">
            <span style="font-size:18px; font-weight:bold;">File:</span>
            <span style="font-size:18px; font-weight:normal;">PRG005_ArgExample5.HTML</span>
        </div>
        <div style="float:left; clear:both;">
            <span style="font-size:18px; font-weight:bold;">Code:</span>
            <span style="font-size:18px; font-weight:normal;">PRG005</span>
        </div>
        <div style="float:left; clear:both;">
            <span style="font-size:18px; font-weight:bold;">Name:</span>
            <span style="font-size:18px; font-weight:normal;">ArgExample5</span>
        </div>
        <div style="float:left; clear:both;">
            <span style="font-size:18px; font-weight:bold;">Desc:</span>
            <span style="font-size:18px; font-weight:normal;">
                This program demonstrates using arguments of type array {ref} when passing parameters to functions. 
                In this demonstration program the array argument is assigned to both a function and a class variable 
                and the resulting array element values are printed to output using the system function SYS::wr.
            </span>            
        </div>
    </body>
</html>